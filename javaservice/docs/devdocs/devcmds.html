<html>
<head>
<title>JavaService - Java NT Service Adaptor</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="../resources/javaservice.css" type="text/css">
</head>

<body bgcolor="#FFFFFF">
<table border="0" cellspacing="0" cellpadding="0" align="center">
  <tr> 
    <td nowrap class="mainTitle"><h2>JavaService - Developer Commands</h2></td>
  </tr>
  <tr> 
    <td> 
      <h3>Contents</h3>
      <blockquote> 
        <p class="mainNormal">
          <a href="#Installing">Installing</a> <br>
          <a href="#UnInstalling">UnInstalling</a><br>
          <a href="#Version_Query">Version Query</a><br>
          <a href="#Registry_Settings">Registry Settings</a><br>
          <a href="#Event_Logging">Event Logging</a><br>
      </blockquote>

      <p class="mainBold"><a name="Installing"></a>Installing</p>
      <p class="mainNormal">The JavaService executable has no dependencies on 
        any files or directories. This was intentional so that it could easily 
        be used with any Java software. Additionally, it does not have a dependency 
        on the name JavaService.exe. This means that you can, and probably should, 
        rename it to something more appropriate. This can be quite useful when 
        checking the Task Manager to see how much CPU time a particular service 
        is using, or how many threads it has created. Instead of seeing multiple 
        entries for JavaService.exe you see a unique entry for each renamed version 
        of the executable. Follow these instructions to use JavaService with your 
        Java application:</p>
      <ol class="mainNormal">
        <li>Unzip the archive into a directory appropriate for your application. 
          The following files will be extracted:</li>
        <ul class="mainNormal">
          <li>bin/JavaService.exe - The service executable.</li>
          <li>bin/installTomcat4.bat - A sample usage to install the service for 
            Tomcat 4.</li>
          <li>bin/installTomcat32.bat - A sample usage to install the service 
            for Tomcat 3.2.</li>
          <li>bin/installTomcat31.bat - A sample usage to install the service 
            for Tomcat 3.1.</li>
          <li>bin/installOrion.bat - A sample usage to install the service for Orion.</li>
          <li>bin/test_install_orion.bat - A test usage to invoke the Orion service installer.</li>
          <li>bin/test_uninstall_orion.bat - A test usage to remove the installed Orion service.</li>
          <li>bin/installJBoss.bat - A sample usage to install the service for JBoss 3.x.</li>
          <li>bin/test_install_jboss.bat - A test usage to invoke the JBoss service installer.</li>
          <li>bin/test_uninstall_jboss.bat - A test usage to remove the installed JBoss service.</li>
          <li>docs/documentation.html - This documentation.</li>
          <li>docs/license.html - The license for distributing this product.</li>
          <li>docs/overview.html - High-level introductory documentation.</li>
          <li>docs/history.html - Release notes and change history.</li>
          <li>docs/faq.html - Frequently-Asked Questions.</li>
          <li>docs/styles.css - Formatting stylesheet for HTML documentation.<br>
            <br>
          </li>
        </ul>
        <li>Copy the JavaService.exe file to a directory appropriate for your 
          application, and optionally rename JavaService.exe to something more 
          relevant.<br>
          <br>
        </li>
        <li>Start a command prompt and change to the directory where the JavaService.exe 
          is located.<br>
          <br>
        </li>
        <li>Type <span class="textCode">'JavaService.exe -install'</span> followed 
          by the proper parameters, as described below. Be sure to use quotation 
          marks around parameters with spaces (<i>italics signify an application 
          dependent value</i>):<br>
          <br>
          <ul>
            <li><i>service_name</i> (mandatory) - The name that you want to use 
              for this service. This is what the service will show up as in the 
              service control manager.<br>
              <br>
            </li>
            <li><i>jvm_library</i> (mandatory) - The location of the jvm.dll file 
              that you want to use as your Java Virtual Machine. For Sun's Java 
              2 SDK, this is usually {JDK_HOME}\jre\bin\classic\jvm.dll or {JDK_HOME}\jre\bin\hotspot\jvm.dll.<br>
              <br>
            </li>
            <li><i>jvm_option</i>* (optional) - Optionally specify any necessary 
              parameters to pass to the JVM upon invocation. These may include 
              thing such as &quot;-Djava.class.path=&quot; to specify a classpath 
              or &quot;-Xmx128m&quot; to specify a maximum heap size of 128MB. 
              Any parameters that you need to use when invoking the java.exe command 
              tool should be specified here. There is no limit to the number of 
              parameters specified.<br>
              <br>
            </li>
            <li>-start <i>start_class</i> (mandatory) - The name of the class 
              that you wish to use when starting the service. This must be the 
              fully qualified class name.<br>
              <br>
            </li>
            <li>-method <i>start_method</i> (optional) - The name of the static 
              method of the <i>start_class</i> that you wish to call to start 
              the service. The method must be <span class="textCode">static</span>, 
              must return type <span class="textCode">void</span>, and must take 
              a <span class="textCode">String[]</span> as its only parameter. 
              If this parameter is not specified it defaults to <span class="textCode">main</span>.<br>
              <br>
            </li>
            <li>-params <i>start_parameter</i>+ (optional) - Any parameters to 
              pass to the <i>start_method</i> when starting the service. These 
              will be passed in as the <span class="textCode">String[]</span> 
              parameter.<br>
              <br>
            </li>
            <li>-stop <i>stop_class</i> (optional) - The name of the class that 
              you wish to use when stopping the service. This must be the fully 
              qualified class name. If no <i>stop_class</i> is specified, the 
              process containing the Virtual Machine is simply terminated when 
              the service is stopped.<br>
              <br>
            </li>
            <li>-method <i>stop_method</i> (optional, but only allowed if a <i>stop_class</i> 
              was specified) - The name of the static method of the <i>stop_class</i> 
              that you wish to call to stop the service. The method must be <span class="textCode">static</span>, 
              must return type <span class="textCode">void</span>, and must take 
              a <span class="textCode">String[]</span> as its only parameter. 
              If this parameter is not specified it defaults to <span class="textCode">main</span>.<br>
              <br>
            </li>
            <li>-params <i>start_parameter</i>+ (optional, but only allowed if 
              a <i>stop_class</i> was specified) - Any parameters to pass to the 
              <i>stop_method</i> when stopping the service. These will be passed 
              in as the <span class="textCode">String[]</span> parameter.<br>
              <br>
            </li>
            <li>-out <i>out_log_file</i> (optional) - A file into which System.out 
              will be redirected. If this parameter is not specified, System.out 
              will not be redirected.<br>
              <br>
            </li>
            <li>-err<i> err_log_file</i> (optional) - A file into which System.err 
              will be redirected. If this parameter is not specified, System.err 
              will not be redirected.<br>
              <br>
            </li>
            <li>-current<i> current_dir</i> (optional) - A directory to use as 
              the current working directory for the service. If this parameter 
              is specified, all relative paths in the service will be relative 
              to relative to the specified directory.<br>
              <br>
            </li>
            <li>-path<i> extra_path</i> (optional) - An addition to the path for 
              the service. The specified path will be appended to the system path 
              before the service is started. This can be used to specify where 
              additional DLLs that native libraries are dependent upon can be 
              found.<br>
              <br>
            </li>
            <li>-depends<i> other_services</i> (optional) - Another NT service (or multiple services,
			if specified as a comma-separated list) that
			must be running before this particular java service can start. Will cause
			the named service(s) to be started automatically if required when starting
			the java service. Will also stop the java service if a specified service is stopped
			(usually with user confirmation first being requested by Windows NT).<br>
			<br>
			</li>
            <li>-auto <i>or</i> -manual - Optional parameter indicating whether service
			should be run automatically on system startup (default mode), or if it should
			be started on demand using a manual command (i.e. net start service).<br>
            <br>
			</li>
            <li>-shutdown<i> seconds</i> (optional) - Specify the amount of time that
			may be taken during processing of your shutdown/stop method. The value here
			is used as a timeout, so if the method has not completed in this length of time,
			the JVM process will be terminated to allow the service to shutdown completely.<br>
			<br>
			</li>
            <li>-user<i> user_name</i> (optional) - Specify the Windows domain username to be
			used when running the service (also requires that the password parameter is specified).<br>
			Note that this should generally be specified in Windows 2000 Active Directory style (i.e.&nbsp;johndoe@foobar.com)<br>
			<br>
			</li>
            <li>-password<i> password</i> (optional) - Specify the Windows password associated with
			the domain username specified for use when running the service (specify with user parameter).<br>
			<br>
			</li>
            <li>-append <i>or</i> -overwrite - Optional parameter indicating whether output
			and error log files are to be appended to, or overwritten, on each service startup.
			If not specified, the default is to append to existing log files.<br>
            <br>
			</li>
          </ul>
        </li>
      </ol>
      <p class="mainNormal">A simple example might look like the following:</p>
      <blockquote> 
        <p class="mainCode">JavaService.exe -install &quot;My Service&quot; c:\jdk\jre\bin\classic\jvm.dll 
          -Djava.class.path=c:\app\classes.jar -start com.my.ExampleClass -err 
          c:\app\stderr.txt</p>
      </blockquote>
      <p class="mainNormal">This would create a service that, when started, would 
        create a JVM from the JDK in c:\jdk setting the classpath to be c:\app\classes.jar. 
        It would then call the main method of the com.my.ExampleClass class with 
        a String array of length 0 (no parameters). Anything written to System.err 
        would be redirected into the file c:\app\stderr.txt.<br>
      </p>

      <p class="mainBold"><a name="UnInstalling"></a>UnInstalling</p>
      <ol class="mainNormal">
        <li>Start a command prompt and change to the directory where the JavaService.exe 
          is located.</li>
        <li>Type <span class="textCode">'JavaService.exe -uninstall'</span> followed 
          by the name of the service.</li>
      </ol>

      <p class="mainBold"><a name="Version_Query"></a>Version Query</p>
      <p class="mainNormal">There are two ways to determine the version number of this program.
	  <br>First:</p>
      <ol class="mainNormal">
        <li>Start a command prompt and change to the directory where the JavaService.exe 
          is located.</li>
        <li>Type <span class="textCode">'JavaService.exe -version'</span> 
          and the program will display version and copyright information.</li>
      </ol>
      <p class="mainNormal">Alternatively:</p>
      <ol class="mainNormal">
	  <li>Locate and select the file <em>JavaService.exe</em> in Windows Explorer.</li>
      <li>View the properties of this executable file by either pressing <em>Alt+Enter</em>
		  or by using the right-click menu and selecting <em>Properties</em> from the list.</li>
	 <li>The version number and copyright information for the program can then be viewed from the property tabs
		  displayed by Windows.</li>
      </ol>

      <p class="mainBold"><a name="Registry_Settings"></a>Registry Settings</p>
      <p class="mainNormal">JavaService stores the configuration information for 
        installed services in the registry. The location is </p>
      <blockquote> 
        <p class="mainNormal">HKEY_LOCAL_MACHINE\ SYSTEM\ CurrentControlSet\ Services\ 
          {SERVICE_NAME}\ Parameters</p>
      </blockquote>
      <p class="mainNormal">The following keys are used and may be changed after 
        service installation to modify the behavior of the service.</p>
      <blockquote> 
        <p class="mainNormal">Current Directory - The current working directory 
          for the service.</p>
        <p class="mainNormal">JVM Library - The location of the jvm.dll library 
          to use to create the Java Virtual Machine.</p>
        <p class="mainNormal">JVM Option Count - The number of option to pass 
          to the JVM when creating it.</p>
        <p class="mainNormal">JVM Option Number <i>n</i> - An option to pass to 
          the JVM. <i>n</i> ranges from 0 to &quot;JVM Option Count&quot; - 1.</p>
        <p class="mainNormal">Path - Extra path information that will be appended 
          to the system path before the service is started.</p>
        <p class="mainNormal">Start Class - The class to use to start the service.</p>
        <p class="mainNormal">Start Method - The static method to call on the 
          &quot;Start Class&quot; to start the service.</p>
        <p class="mainNormal">Start Param Count - The number of parameters to 
          pass to the &quot;Start Method&quot; to start the service.</p>
        <p class="mainNormal">Start Param Number n - A parameter to pass to the 
          &quot;Start Method&quot; to start the service. n ranges from 0 to &quot;Start 
          Param Count&quot; - 1.</p>
        <p class="mainNormal">Stop Class - The class to use to stop the service. 
          If this key is absent, the process containing the JVM will simply be 
          terminated when the service is stopped.</p>
        <p class="mainNormal">Stop Method - The static method to call on the &quot;Stop 
          Class&quot; to stop the service.</p>
        <p class="mainNormal">Stop Param Count - The number of parameters to pass 
          to the &quot;Stop Method&quot; to stop the service.</p>
        <p class="mainNormal">Stop Param Number n - A parameter to pass to the 
          &quot;Stop Method&quot; to stop the service. n ranges from 0 to &quot;Stop 
          Param Count&quot; - 1.</p>
        <p class="mainNormal">System.err File - A file into which System.err will 
          be redirected. If this key is absent, System.err will not be redirected.</p>
        <p class="mainNormal">System.out File - A file into which System.out will 
          be redirected. If this key is absent, System.out will not be redirected.</p>
        <p class="mainNormal">Shutdown Timeout - The number of milliseconds to allow for
		the Java Stop method to complete, before timeout and JVM forced termination.</p>
      </blockquote>

      <p class="mainBold"><a name="Event_Logging"></a>Event Logging</p>
      <p class="mainNormal">JavaService logs both informational events and errors 
        into the Application portion of the NT Event Log. Informational messages 
        include a message when the service is started and one when it is stopped. 
        Error messages may be logged because of a configuration problem or other 
        system error. If you are having trouble getting JavaService to run your 
        application, you should first check the Application portion of the Event 
        Log to see if any errors were reported. Additionally you can check the 
        redirected System.err file, as any Java exceptions will be written there 
        by the Virtual Machine.</p>
	  
    </td>
  </tr>
</table>
</body>
</html>
